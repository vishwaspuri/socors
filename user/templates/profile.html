{% load static %}
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="{% static 'css/profile.css' %}">
    <link
      rel="stylesheet"
      href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/4.4.1/css/bootstrap.min.css"
      integrity="sha256-L/W5Wfqfa0sdBNIKN9cG6QA5F2qx4qICmU2VgLruv9Y="
      crossorigin="anonymous"
    />
    <link href="https://fonts.googleapis.com/css2?family=Nunito:wght@600;800&display=swap" rel="stylesheet">
	<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">
	<link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.13.1/css/all.css" integrity="sha384-xxzQGERXS00kBmZW/6qxqJPyxW3UR0BPsL4c8ILaIWXva5kFi7TxkIIaMiKtqV1Q" crossorigin="anonymous">

    <title>Profile</title>
</head>
<body>
    <nav class="navbar navbar-expand-xxl navbar-dark bg justify-content-xxl-start fixed-top">
        <a class="navbar-brand order-0 ml-xxl-0 ml-2 mr-auto" href="{% url 'main:menu' %}">SOCORS</a>
		<a id="notification" href="{% url 'main:notifications' %}"><span class="fas fa-bell" id="bell"></span>
			<span class="badge badge-danger rounded-circle" id="bell_num">5</span>
			<!-- if no notification -->
			<!-- <span class="badge badge-danger rounded-circle invisible">5</span> -->
		</a> 
		<button id="tri" class="navbar-toggler align-self-start" type="button">
          <span class="navbar-toggler-icon"></span>
        </button>
        <div class="collapse navbar-collapse d-flex flex-column flex-xxl-row bg mobileMenu" id="navbarSupportedContent">
          
          <div class="picture">
            <img src="{% static 'images/user_dp.png' %}" alt="profile_picture" class="dp">
              <p id="nav_name" class="mb-0">{{ user.full_name }}<a href="{% url 'user:update-profile' %}"> <img src="{% static 'images/edit_icon.png' %}" alt=""></a></p></p>
          </div>

          <div class="list">
            <ul class="navbar-nav align-self-stretch" id="menu">
              <li class="nav-item">
                <a class="link" href="{% url 'user:profile' %}">My Profile</a>
              </li>
			  <li class="nav-item">
                <a class="link" href="{% url 'main:explore' %}">Home</a>
              </li>
              <li class="nav-item">
                <a class="link" href="{% url 'main:menu' %}">Explore</a>
              </li>
              <li class="nav-item">
                <a class="link" href="{% url 'main:mytimeslots' %}" tabindex="-1" aria-disabled="true">My Timeslots</a>
              </li>
              <li class="nav-item">
                <a class="link" href="{% url 'user:add-address' %}" tabindex="-1" aria-disabled="true">Add Address</a>
              </li>
              <li class="nav-item">
                <a class="link" href="{% url 'main:notifications' %}" tabindex="-1" aria-disabled="true">Notifications</a>
              </li>
              <li class="nav-item">
                <a class="link" href="{% url 'user:logout' %}" tabindex="-1" aria-disabled="true">Logout</a>
              </li>
            </ul>
          </div>
        </div>
      </nav>

    <div class="overlay"></div>


    <div class="content">
		<div class="row"> 
			<h1 class="col-4">Profile</h1>
		</div>
		<div class="user_photo">
		<img class="userDP" src="{% static 'images/userDP.png' %}" alt="profile_photo">
		<button type="button" class="edit-btn btn bg-transparent shadow-none" data-toggle="modal" data-target="#EditModalProfilePicture">
			<img  src="{% static 'images/cam.png' %}" alt="edit">
		</button>
		</div>
		<br>
		
		<!--Edit Modal Profile Picture-->

		<div id="EditModalProfilePicture" class="modal fade" role="dialog">
			<div class="modal-dialog modal-lg" role="content">
				<!-- Modal content-->
				<div class="modal-content">
					<div class="modal-header bg-primary">
						<h4 class="modal-title text-white">Edit Profile Picture </h4>
						<button type="button" class="close text-white" data-dismiss="modal">&times;</button>
					</div>
					<div class="modal-body">
						<form>
							<div class="row">
								<label class="col-form-label col-12" for="current"><strong>Current Profile Picture</strong></label>
								<!--if no image-->
								<!--<span id="current" class="m-auto badge badge-danger">None</span>-->
								<!--else-->
								<img id="current" class="userDP m-auto" src="{% static 'images/userDP.png' %}" alt="profile_photo">
							</div>
							<br>
							<div class="form-group row">
								<label class="col-form-label col-12" for="select"><strong>Select a new photo</strong></label>
								<input type="file" id="select" name="img" class="col-8 col-sm-6 m-auto form-control h-100" accept="image/*" value="">
							</div>
							<div class="row">
								<button type="submit" class="col-4 btn btn-block m-auto text-white" data-toggle="modal" data-target="#Change">Save</button>
							</div>
						</form>
					</div>
				</div>
			</div>
		</div>
		
		<!--General Information-->
		<div id="gen_info" class="ml-4">
			<div class="row mb-4 ml-1">
				<div class="header">General Information</div>
			</div>
			
			<div class="row">
				<div class="col-3">
					<i class="fa fa-user" id="name" aria-hidden="true" style="font-size: 30px;"></i>
				</div>
				<div class="col">
					<div class="row">
						<span>Name</span>
					</div>
					<div class="row">
						<span>{{ user.full_name }}</span>
					</div>
				</div>
			</div>
			<div class="row">
				<div class="col-3">
					<i class="fa fa-mobile text-primary" id="phone_num" aria-hidden="true" style="font-size: 35px;"></i>
				</div>
				<div class="col">
					<div class="row">
						<span>Mobile No.</span>
					</div>
					<div class="row">
						<span>{{ user.ph_number }}</span>
					</div>
				</div>
			</div>
			<div class="row">
				<div class="col-3">
					<i class="fa fa-envelope text-success" id="email" aria-hidden="true" style="font-size: 25px;"></i>
				</div>
				<div class="col">
					<div class="row">
						<span>Email-ID</span>
					</div>
					<div class="row">
						<span>{{ user.email }}</span>
					</div>
				</div>
			</div>
			<div class="row">
				<div class="col-4 offset-4">
				<a class="btn btn-block  text-white" data-toggle="modal" data-target="#EditModal1">Edit</a>
				</div>
			</div>		
		</div>

        <!--Edit Modal 1-->

		<div id="EditModal1" class="modal fade" role="dialog">
			<div class="modal-dialog modal-lg" role="content">
				<!-- Modal content-->
				<div class="modal-content">
					<div class="modal-header bg-primary">
						<h4 class="modal-title text-white">Edit General Information </h4>
						<button type="button" class="close text-white" data-dismiss="modal">&times;</button>
					</div>
					<div class="modal-body">
						<form class="p-1 mt-4" method="POST" action="{% url 'user:update-profile' %}">
							{% csrf_token %}
							<div class="form-group row">
								<label for="name" class="col-3 col-form-label">Name</label>
								<div class="col-9">
									<input type="text" class="form-control text-left"  placeholder="{{ user.full_name }}" id="name" name="full_name" value="{{ user.full_name }}">
								</div>
							</div>
							<div class="form-group row">
								<label for="telnum" class="col-3 col-form-label">Phone</label>
								<div class="col-9">
									<input type="tel" class="form-control text-left" id="telnum" name="ph_number" placeholder="{{ user.ph_number }}" value="{{ user.ph_number }}">
								</div>
							</div>

							<div class="form-group row">
								<label for="emailid" class="col-3 col-form-label">Email</label>
								<div class="col-9">
									<input type="email" class="form-control text-left" id="emailid" name="email" value="{{ user.email }}">
								</div>
							</div>


							<div class="form-group row">
								<div class="offset-4 col-4 mt-3">
									<button type="submit" class="btn btn-block text-white">Save</button>
								</div>
							</div>

						</form>
					</div>
				</div>
			</div>
		</div>

		<!--Addresses-->
        <div class="row ml-1 mb-2">
		    <div class="header">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Address</div>
        </div>
		{% for address in user.address.all %}
        {% with address.class_name as block_id %}
		<div id="addresses" class="ml-4">
			<div class="row mr-1">
				<div class="col-12">
					<div class="address">
						<div class="row ml-2 mt-2">
							<span><strong>Street :</strong></span>
							<span>{{ address.street }}</span>
						</div>
						<div class="row ml-2">
							<span><strong>Area: </strong></span>
							<span>{{ address.area }}</span>
						</div>
						<div class="row ml-2">
							<span><strong>City: </strong></span>
							<span>{{ address.city }}</span>
						</div>
						<div class="row ml-2">
							<span><strong>State: </strong></span>
							<span>{{ address.state }}</span>
							<span class="pl-2"><strong>Pincode: </strong></span>
							<span>{{ address.pincode }}</span>
						</div>
                        <div class="row m-3">
                                <div class="col-5 offset-1">
									<form>
										<a class="btn btn-block text-white" data-toggle="modal" data-target="#{{ block_id }}">Edit</a>
									</form>
                                </div>
							<div class="col-5">
                                <form method="POST" action="{% url 'user:remove-address' %}">
                                    {% csrf_token %}
                                    <input type="hidden" name="address_pk" value="{{ address.id }}">
								    <button class="btn btn-block text-white" type="submit">Remove</button>
                                </form>
                            </div>
                            </div>
						</div>
					</div>
				</div>
			</div>
		
		<!--Edit Modal 2-->
		
		<div id="{{ block_id }}" class="modal fade" role="dialog">
			<div class="modal-dialog modal-lg" role="content">
				<!-- Modal content-->
				<div class="modal-content">
					<div class="modal-header bg-primary">
						<h4 class="modal-title text-white">Edit Address</h4>
						<button type="button" class="close text-white" data-dismiss="modal">&times;</button>
					</div>
					<div class="modal-body">
                        <form class="p-1 mt-4" method="POST" action="{% url 'user:edit-address' %}">
                            {% csrf_token %}
							{% if address.is_main %}
                                <span class="badge badge-success mb-4">Current Address</span>
                                <input type="hidden" name="make_main_address" value="False">
							{% else %}
							<div class="form-group row">									
								<label for="select" class=" col-9 form-label text-left">Make Current Addres</label>
                                <input type="checkbox" class="col-3 align-center" name="make_main_address" value="True">
							</div>
							{% endif %}
							<div class="form-group row">
								<label for="street" class="col-3 col-form-label">Street:</label>
								<div class="col-9">
									<input type="text" class="form-control text-left"  placeholder="{{ address.street }}" id="street" name="street" value="{{ address.street }}">
								</div>
							</div>
							<div class="form-group row">
								<label for="area" class="col-3 col-form-label">Area:</label>
								<div class="col-9">
									<input type="text" class="form-control text-left"  placeholder="{{ address.area }}" id="area" name="area" value="{{ address.area }}">
								</div>
							</div>
							<div class="form-group row">
								<label for="city" class="col-3 col-form-label">City:</label>
								<div class="col-9">
									<input type="text" class="form-control text-left"  placeholder="{{ address.city }}" id="city" name="city" value="{{ address.city }}">
								</div>
							</div>
							<div class="form-group row">
								<label for="state" class="col-3 col-form-label">State:</label>
								<div class="col-9">
									<input type="text" class="form-control text-left"  placeholder="{{ address.state }}" id="state" name="state" value="{{ address.state }}">
								</div>
							</div>
							<div class="form-group row">
								<label for="pincode" class="col-3 col-form-label">Pincode:</label>
								<div class="col-9">
									<input type="text" class="form-control text-left"  placeholder="{{ address.pincode }}" id="pincode" name="pincode" value="{{ address.pincode }}">
								</div>
							</div>
					        <input type="hidden" value="{{ address.id }}" name="address_id">
							<div class="form-group row">
								<div class="col-5 mt-3 offset-1">
									<button type="submit" class="btn btn-block text-white">Save</button>
								</div>
                        </form>
                                <div class="col-5 mt-3">
                                    <form method="POST" action="{% url 'user:remove-address' %}">
                                        {% csrf_token %}
                                        <input type="hidden" name="address_pk" value="{{ address.id }}">
							            <button type="submit" class="btn btn-block text-white">Remove</button>
                                    </form>
						        </div>
                            </div>
					</div>
				</div>
			</div>
		</div>
        {% endwith %}
		{% endfor %}
		<br>
		<!--if no address-->
		<div class="row ml-3">
			<div class="col-6 offset-3">
				<a class="btn text-white btn-block" id="add_address" href="{% url 'user:add-address' %}">Add Address</a>				
			</div>
		</div>
		<br>
		<br>
	</div>
    <script
			  src="https://code.jquery.com/jquery-3.5.1.min.js"
			  integrity="sha256-9/aliU8dGd2tb6OSsuzixeV4y/faTqgFtohetphbbj0="
              crossorigin="anonymous"></script>
              
              <script
              src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/4.4.1/js/bootstrap.bundle.min.js"
              integrity="sha256-OUFW7hFO0/r5aEGTQOz9F/aXQOt+TwqI1Z4fbVvww04="
              crossorigin="anonymous"
            ></script>

    <script src="{% static 'js/profile.js' %}"></script>
</body>
</html>